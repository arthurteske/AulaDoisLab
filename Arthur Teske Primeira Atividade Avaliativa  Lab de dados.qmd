---
title: "Gr√°ficos - Arthur"
format: 
  html:
    theme: darkly
editor: visual
---

```{r}
#| label: load-packages
#| include: false

library(tidyverse)
library(palmerpenguins)
```

## Atividade Avaliativa I

Apresenta√ß√£o da primeira atividade avaliativa da mat√©ria de laborat√≥rio de dados, quinto semestre de ci√™ncias econ√¥micas da institui√ß√£o FURB, 2025.

## Gr√°fico de Dispers√£o

No gr√°fico abaixo podemos identificar a rela√ß√£o entre importa√ß√µes e exporta√ß√µes de algumas das principais economias do mundo em 2023. A dispers√£o revela que pa√≠ses como os Estados Unidos e a China se destacam com os maiores volumes de importa√ß√µes e exporta√ß√µes, ambos superando 3000 bilh√µes de d√≥lares em cada categoria, o que reflete suas posi√ß√µes como pot√™ncias econ√¥micas globais. A Alemanha tamb√©m apresenta valores elevados, com exporta√ß√µes e importa√ß√µes pr√≥ximas de 2000 bilh√µes de d√≥lares, evidenciando sua forte presen√ßa no com√©rcio internacional.

Por outro lado, o Brasil, a √çndia, o Jap√£o, a It√°lia e a Fran√ßa possuem volumes menores, todos abaixo de 1000 bilh√µes de d√≥lares, com o Brasil registrando os menores valores entre os pa√≠ses analisados, com importa√ß√µes e exporta√ß√µes em torno de 500 bilh√µes de d√≥lares. A proximidade dos pontos √† diagonal impl√≠cita sugere uma rela√ß√£o relativamente equilibrada entre importa√ß√µes e exporta√ß√µes para a maioria desses pa√≠ses, indicando que o valor das importa√ß√µes tende a acompanhar o das exporta√ß√µes.

As vari√°veis utilizadas para compor o gr√°fico foram extra√≠das do banco de dados do Banco Mundial (WDI), sendo elas:\
**Importa√ß√µes de bens e servi√ßos (US\$ atuais)** ‚Äî c√≥digo **NE.IMP.GNFS.CD**\
**Exporta√ß√µes de bens e servi√ßos (US\$ atuais)** ‚Äî c√≥digo **NE.EXP.GNFS.CD**

```{r}
#| label: plot-penguins
#| echo: false
#| warning: false
##CORTE  TRANSVERSAL
### COLETAR DADOS DE DUAS VARI√ÅVEIS
#PACOTES####
#install.packages('WDI') #PRIMEIRO A EXECUTAR
library(WDI)
library(ggplot2)
library(scales)
library(ggrepel)
library(dplyr)  # Para usar a fun√ß√£o recode
options(scipen = 9)

# Vari√°veis
variaveis <- c("IMP" = 'NE.IMP.GNFS.CD', "EXP" = 'NE.EXP.GNFS.CD')

# Baixar os dados do WDI
dados <- WDI(country = "all", 
             indicator = c("IMP" = "NE.IMP.GNFS.CD", "EXP" = "NE.EXP.GNFS.CD"), 
             start = 2023, 
             end = 2023)

# Filtrar para remover agregados
dados <- dados[!grepl("World|Union|Region|Developing|Developed|OECD|Euro|High income|Low income|Middle income", 
                      dados$country, ignore.case = TRUE), ]

# Lista de pa√≠ses principais
paises_principais <- c("Brazil", "United States", "China", "India", "Germany", "Japan", "Italy", "France")

# Filtrar para manter apenas os pa√≠ses principais
dados <- dados[dados$country %in% paises_principais, ]

# Substituir os nomes dos pa√≠ses para portugu√™s do Brasil
dados$country <- recode(dados$country,
                        "Brazil" = "Brasil",
                        "United States" = "Estados Unidos",
                        "China" = "China",
                        "India" = "√çndia",
                        "Germany" = "Alemanha",
                        "Japan" = "Jap√£o",
                        "Italy" = "It√°lia",
                        "France" = "Fran√ßa")

# Fun√ß√£o para formatar os valores em bilh√µes
formato_bilhoes <- function(x) {
  paste0(x / 1e9, " bi")
}

# Criar uma coluna para destacar o Brasil com um tamanho maior
dados$size <- ifelse(dados$country == "Brasil", 4, 2)

# Criar o gr√°fico de dispers√£o
ggplot(dados, aes(x = EXP, y = IMP)) +
  # Plotar os pontos com tamanhos diferentes (todos em vermelho)
  geom_point(color = "red", aes(size = size)) +
  scale_size_identity() +
  # Adicionar r√≥tulos para todos os pa√≠ses
  geom_text_repel(aes(label = country), 
                  size = 4, 
                  box.padding = 1, 
                  point.padding = 0.5, 
                  force = 10, 
                  nudge_y = ifelse(dados$country == "Brasil", 2e11, 0), 
                  max.overlaps = Inf, 
                  segment.color = "gray50", 
                  segment.size = 0.5) +
  # Formatar os eixos
  scale_x_continuous(labels = formato_bilhoes, 
                     breaks = seq(0, 5e12, by = 1e12), 
                     limits = c(0, 5e12)) +
  scale_y_continuous(labels = formato_bilhoes, 
                     breaks = seq(0, 5e12, by = 1e12), 
                     limits = c(0, 5e12)) +
  # T√≠tulos e labels
  labs(title = "Dispers√£o entre Exporta√ß√µes e Importa√ß√µes (2023)", 
       x = "Exporta√ß√µes (US$)", 
       y = "Importa√ß√µes (US$)") +
  # Tema ajustado
  theme_minimal(base_size = 14) +
  theme(legend.position = "none", 
        axis.title.x = element_text(margin = margin(t = 15)), 
        axis.title.y = element_text(margin = margin(r = 15)), 
        plot.title = element_text(hjust = 0.5, face = "bold"), 
        panel.grid.major = element_line(color = "gray90"), 
        panel.grid.minor = element_line(color = "gray95"))
```

## Gr√°fico Temporal

No gr√°fico abaixo podemos observar a evolu√ß√£o do acesso √† internet pela popula√ß√£o japonesa entre os anos de 1986 e 2022. A linha do tempo revela uma trajet√≥ria de crescimento cont√≠nuo, especialmente a partir do in√≠cio dos anos 2000. Esse cen√°rio come√ßa a mudar com o avan√ßo das tecnologias digitais, e a partir de 2000 o Jap√£o passa a registrar um crescimento acelerado na propor√ß√£o de habitantes conectados √† internet.

Durante a d√©cada de 2000, o percentual de acesso mais que triplica, refletindo a expans√£o da infraestrutura digital e a maior dissemina√ß√£o da internet no cotidiano da sociedade.

A partir de 2010, o pa√≠s alcan√ßa n√≠veis superiores a 80%, mantendo-se relativamente est√°vel nos anos seguintes, o que sugere uma maturidade tecnol√≥gica e uma cobertura quase total da popula√ß√£o. A marca de 90% √© atingida ap√≥s 2015, consolidando o Jap√£o como uma das na√ß√µes com maior n√≠vel de conectividade digital no mundo.

Os dados utilizados nesta an√°lise foram extra√≠dos do banco de dados **World Development Indicators (WDI)**, utilizando a vari√°vel **‚ÄúInternet users (per 100 people)‚Äù**, identificada pelo c√≥digo **IT.NET.USER.ZS**, que representa o percentual da popula√ß√£o com acesso √† internet.

```{R}
#| label: grafico-japao-final
#| echo: false
#| warning: false
#| message: false



library(WDI)
library(ggplot2)
library(gganimate)
library(dplyr)

# Dados de acesso √† internet no Jap√£o
dados_japao <- WDI(country = "JP", 
                   indicator = "IT.NET.USER.ZS", 
                   start = 1986, end = 2022)

colnames(dados_japao)[colnames(dados_japao) == "IT.NET.USER.ZS"] <- "Internet"

# Criar colunas auxiliares
dados_japao <- dados_japao %>%
  mutate(
    label_pct = ifelse(year %% 10 == 0, paste0(round(Internet), "%"), NA),
    pausa = ifelse(year %% 10 == 0, 3, 1)  # pausa de 3s nos anos m√∫ltiplos de 10
  )

# Gr√°fico com destaque maior nas porcentagens
grafico <- ggplot(dados_japao, aes(x = year, y = Internet)) +
  geom_line(color = "gray80", size = 1.2) +  # linha base
  
  # bolinhas pequenas que mostram o passado
  geom_point(aes(group = 1), color = "purple", size = 3, alpha = 0.4) +
  
  # bolinha atual grande
  geom_point(aes(group = 1), color = "purple", size = 6) +
  
  # porcentagem apenas em anos selecionados
  geom_text(aes(label = label_pct), 
            vjust = -1.5, size = 6, fontface = "bold",
            color = "purple", na.rm = TRUE) +
  
  labs(
    title = "üåê Evolu√ß√£o do Acesso √† Internet no Jap√£o (1986-2022) üåê",
    subtitle = "Ano: {closest_state}",
    x = "Ano", y = "% da Popula√ß√£o"
  ) +
  ylim(0, 105) +
  theme_minimal(base_size = 14) +
  
  # anima√ß√£o
  transition_states(
    states = year,
    transition_length = 1,
    state_length = dados_japao$pausa
  ) +
  shadow_mark(past = TRUE, future = FALSE, colour = "purple", size = 3, alpha = 0.4) +
  ease_aes('linear')

grafico
```

\
